<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Reads the issuer field according to the spec"><title>read_issuer in hickory_proto::rr::rdata::caa - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-916cea96.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="hickory_proto" data-themes="" data-resource-suffix="" data-rustdoc-version="1.87.0 (17067e9ac 2025-05-09)" data-channel="1.87.0" data-search-js="search-e7298875.js" data-settings-js="settings-d72f25bb.js" ><script src="../../../../static.files/storage-82c7156e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../../static.files/main-fb8c74a8.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-044be391.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../hickory_proto/index.html">hickory_<wbr>proto</a><span class="version">0.25.2</span></h2></div><div class="sidebar-elems"><div id="rustdoc-modnav"><h2><a href="index.html">In hickory_<wbr>proto::<wbr>rr::<wbr>rdata::<wbr>caa</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../../index.html">hickory_proto</a>::<wbr><a href="../../index.html">rr</a>::<wbr><a href="../index.html">rdata</a>::<wbr><a href="index.html">caa</a></div><h1>Function <span class="fn">read_issuer</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../../src/hickory_proto/rr/rdata/caa.rs.html#461-579">Source</a> </span></div><pre class="rust item-decl"><code>pub fn read_issuer(
    bytes: &amp;[<a class="primitive" href="https://doc.rust-lang.org/1.87.0/std/primitive.u8.html">u8</a>],
) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.87.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;(<a class="enum" href="https://doc.rust-lang.org/1.87.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../../domain/struct.Name.html" title="struct hickory_proto::rr::domain::Name">Name</a>&gt;, <a class="struct" href="https://doc.rust-lang.org/1.87.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="struct.KeyValue.html" title="struct hickory_proto::rr::rdata::caa::KeyValue">KeyValue</a>&gt;), <a class="struct" href="../../../struct.ProtoError.html" title="struct hickory_proto::ProtoError">ProtoError</a>&gt;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Reads the issuer field according to the spec</p>
<p><a href="https://www.rfc-editor.org/rfc/rfc8659">RFC 8659, DNS Certification Authority Authorization, November 2019</a>,
and <a href="https://www.rfc-editor.org/errata/eid7139">errata 7139</a></p>
<div class="example-wrap"><pre class="language-text"><code>4.2.  CAA issue Property

   If the issue Property Tag is present in the Relevant RRset for an
   FQDN, it is a request that Issuers:

   1.  Perform CAA issue restriction processing for the FQDN, and

   2.  Grant authorization to issue certificates containing that FQDN to
       the holder of the issuer-domain-name or a party acting under the
       explicit authority of the holder of the issuer-domain-name.

   The CAA issue Property Value has the following sub-syntax (specified
   in ABNF as per [RFC5234]).

   issue-value = *WSP [issuer-domain-name *WSP]
      [&quot;;&quot; *WSP [parameters *WSP]]

   issuer-domain-name = label *(&quot;.&quot; label)
   label = (ALPHA / DIGIT) *( *(&quot;-&quot;) (ALPHA / DIGIT))

   parameters = (parameter *WSP &quot;;&quot; *WSP parameters) / parameter
   parameter = parameter-tag *WSP &quot;=&quot; *WSP parameter-value
   parameter-tag = (ALPHA / DIGIT) *( *(&quot;-&quot;) (ALPHA / DIGIT))
   parameter-value = *(%x21-3A / %x3C-7E)

   For consistency with other aspects of DNS administration, FQDN values
   are specified in letter-digit-hyphen Label (LDH-Label) form.

   The following CAA RRset requests that no certificates be issued for
   the FQDN &quot;certs.example.com&quot; by any Issuer other than ca1.example.net
   or ca2.example.org.

   certs.example.com         CAA 0 issue &quot;ca1.example.net&quot;
   certs.example.com         CAA 0 issue &quot;ca2.example.org&quot;

   Because the presence of an issue Property Tag in the Relevant RRset
   for an FQDN restricts issuance, FQDN owners can use an issue Property
   Tag with no issuer-domain-name to request no issuance.

   For example, the following RRset requests that no certificates be
   issued for the FQDN &quot;nocerts.example.com&quot; by any Issuer.

   nocerts.example.com       CAA 0 issue &quot;;&quot;

   An issue Property Tag where the issue-value does not match the ABNF
   grammar MUST be treated the same as one specifying an empty
   issuer-domain-name.  For example, the following malformed CAA RRset
   forbids issuance:

   malformed.example.com     CAA 0 issue &quot;%%%%%&quot;

   CAA authorizations are additive; thus, the result of specifying both
   an empty issuer-domain-name and a non-empty issuer-domain-name is the
   same as specifying just the non-empty issuer-domain-name.

   An Issuer MAY choose to specify parameters that further constrain the
   issue of certificates by that Issuer -- for example, specifying that
   certificates are to be subject to specific validation policies,
   billed to certain accounts, or issued under specific trust anchors.

   For example, if ca1.example.net has requested that its customer
   account.example.com specify their account number &quot;230123&quot; in each of
   the customer&#39;s CAA records using the (CA-defined) &quot;account&quot;
   parameter, it would look like this:

   account.example.com   CAA 0 issue &quot;ca1.example.net; account=230123&quot;

   The semantics of parameters to the issue Property Tag are determined
   by the Issuer alone.</code></pre></div>
<p>Updated parsing rules:</p>
<p><a href="https://www.rfc-editor.org/rfc/rfc8659#name-canonical-presentation-form">RFC8659 Canonical presentation form and ABNF</a></p>
<p>This explicitly allows <code>-</code> in property tags, diverging from the original RFC. To support this,
property tags will allow <code>-</code> as non-starting characters. Additionally, this significantly
relaxes the characters allowed in the value to allow URL like characters (it does not validate
URL syntax).</p>
</div></details></section></div></main></body></html>